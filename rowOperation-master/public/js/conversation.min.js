var ConversationPanel=function(){function e(e,t){var n={};e&&(n.input={text:e}),t&&(n.context=t);var a=new XMLHttpRequest;a.open("POST","judge/oneteam_robot_database_appCode?appCode="+e,!0),a.setRequestHeader("Content-type","application/json"),a.onreadystatechange=function(){if(4===a.readyState&&200===a.status&&a.responseText){var e=JSON.parse(a.responseText);if("false"==e.output.text[0]){e.output.text[0]="Seems I can not find your application or you do not want to see your specific application,what else can I do for you?";var t=JSON.stringify(e);Api.setResponsePayload(t)}else Api.setResponsePayload(a.responseText)}};var s=JSON.stringify(n);a.send(s),localStorage.setItem("gt","0")}function t(t,n){var a={};t&&(a.input={text:t}),n&&(a.context=n);var s=new XMLHttpRequest;s.open("POST","judge/oneteam_robot_database_name?appName="+t,!0),s.setRequestHeader("Content-type","application/json"),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&s.responseText&&("false"==JSON.parse(s.responseText).output.text[0]?e(t,n):Api.setResponsePayload(s.responseText))};var o=JSON.stringify(a);0!==Object.getOwnPropertyNames(a).length&&Api.setRequestPayload(o),s.send(o)}function n(){var e=Api.setRequestPayload;Api.setRequestPayload=function(t){e.call(Api,t),s(JSON.parse(t),m.authorTypes.user),document.getElementById("textInput").readOnly=!0,document.getElementById("refreshImageID").style.visibility="visible"};var t=Api.setResponsePayload;Api.setResponsePayload=function(e){t.call(Api,e),s(JSON.parse(e),m.authorTypes.watson)}}function a(){function e(){if(""===t.value)t.classList.remove("underline"),t.setAttribute("style","width:100%"),t.style.width="100%";else{t.classList.add("underline");var e=document.createTextNode(t.value);["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"].forEach(function(e){n.style[e]=window.getComputedStyle(t,null).getPropertyValue(e)}),n.textContent=e.textContent;var c=0,r=document.getElementsByTagName("html")[0],l=parseInt(window.getComputedStyle(r,null).getPropertyValue("font-size"),10);c=l?Math.floor((l-a)/(s-a)*(i-o)+o):i;var u=n.offsetWidth+c+"px";t.setAttribute("style","width:"+u),t.style.width=u}}var t=document.getElementById("textInput"),n=document.getElementById("textInputDummy"),a=14,s=16,o=4,i=6;if(null===n){var c={tagName:"div",attributes:[{name:"id",value:"textInputDummy"}]};n=Common.buildDomElement(c),document.body.appendChild(n)}t.addEventListener("input",e),window.addEventListener("resize",e),Common.fireEvent(t,"input")}function s(e,t){var n=o(t),a=e.input&&e.input.text||e.output&&e.output.text;if(null!==n&&a){var s=c(e,n),p=document.querySelector(m.selectors.chatBox).querySelectorAll((n?m.selectors.fromUser:m.selectors.fromWatson)+m.selectors.latest);if(p&&Common.listForEach(p,function(e){e.classList.remove("latest")}),s.forEach(function(e){document.getElementById("mCSB_1_container").appendChild(e),e.classList.add("load"),l.push(s[0].textContent)}),window.onbeforeunload=function(e){(e=e||window.event)&&(e.returnValue="Any String"),UTCMonth=u.getUTCMonth()+1,UTCMonth>=10?UTCMonth=UTCMonth:UTCMonth="0"+UTCMonth,UTCDate=u.getUTCDate(),UTCDate>=10?UTCDate=UTCDate:UTCDate="0"+UTCDate,UTCHours=u.getUTCHours(),UTCHours>=10?UTCHours=UTCHours:UTCHours="0"+UTCHours,UTCMinutes=u.getUTCMinutes(),UTCMinutes>=10?UTCMinutes=UTCMinutes:UTCMinutes="0"+UTCMinutes,UTCSeconds=u.getUTCSeconds(),UTCSeconds>=10?UTCSeconds=UTCSeconds:UTCSeconds="0"+UTCSeconds,UTCMilliseconds=u.getUTCMilliseconds(),UTCMilliseconds>=10?UTCMilliseconds=UTCMilliseconds:UTCMilliseconds="0"+UTCMilliseconds,l&&l.length>1?$.post("/judge/oneteam_robot_record",{ChatDate:u.getUTCFullYear()+"-"+UTCMonth+"-"+UTCDate+"  "+UTCHours+":"+UTCMinutes+":"+UTCSeconds+":"+UTCMilliseconds,ChatRecord:JSON.stringify(l)},function(e){1==e.status?console.log("suc"):console.log("wrong")}):console.log("wrong")},0==n&&s.length>0)switch(s[0].textContent){case"The application owner and application administrator can start a recertification in OneTEAM,Please refer to the instruction in this page:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Recertify%20access","../img/recertify_access.png");break;case"You want to update your access, this is a OneTEAM general user function, please see below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Update%20access","../img/update_access.png");break;case"You want to cancel/delete your access, this is a OneTEAM general user function, please see below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Cancel%20or%20Delete%20access","../img/delete_cancle_access.png");break;case"You want to request a new access in OneTEAM, this is a OneTEAM general user function, please see below guide,if you want to request a specific application, please tell me your application code or application name, I will give you the application contact person.":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Request%20access","../img/request_access.png");break;case"You want to replace your access, this is a OneTEAM general user function, please see below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Replace%20access","../img/replace_access.png");break;case"You want to transfer your access, this is a OneTEAM general user fucntion, please see below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Transfer%20access","../img/transfer_access.png");break;case"You want to view your access, this is a OneTEAM general user function, please see below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/View%20my%20access","../img/view_access.png");break;case"You want to see the function MVS id managerment, this is a OneTEAM general user function, please see below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/MVS%20userid%20management","../img/mvs_access.png");break;case"you want to delegate your access, this is a OneTEAM application manager function, please follow below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/delegation","../img/delegation_access.png");break;case"You want to approve access for your application, this is a manager function, please see below guide:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Approve%20access","../img/approve_access.png");break;case"You want to delete/cancel department access, this is a manager function, you can go to:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Cancel%20or%20Delete%20department%20access","../img/cancel_de_access.png");break;case"The application owner and application administrator can start a recertification in OneTEAM,Please refer to the instruction in this page:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/Recertify%20department%20access","../img/recertify_de_access.png");break;case"You want to list your department access, this is a manager function, you can go to:":i("https://w3-connections.ibm.com/wikis/home?lang=en-us#!/wiki/Wc793a5789b07_450b_a9f5_9f6dea91f32e/page/List%20of%20department%20access","../img/list_de_access.png")}r(),document.getElementById("textInput").readOnly=!1,document.getElementById("refreshImageID").style.visibility="hidden",document.getElementsByClassName("loadingChat")[0].style.display="none"}}function o(e){return e===m.authorTypes.user||e!==m.authorTypes.watson&&null}function i(e,t){var n=document.createElement("div"),a=document.createElement("a"),s=document.createElement("img");n.style.height="auto",n.style.width="20.56rem",n.style.margin="0.3125rem",n.style.padding="0 2.2rem",a.innerHTML="link",a.href=e,a.target="_blank",s.src=t,s.style.maxWidth="100%",s.style.height="auto",s.className="imgInfo"+p,document.getElementById("mCSB_1_container").appendChild(n),n.appendChild(a),n.appendChild(s);var o=document.getElementsByClassName("imgInfo"+p)[0];o.addEventListener("click",function(){var e=o.src;window.open(e,"newwindow2","height=600, width=1000,top=0, left=100, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no")},!1),p++}function c(e,t){var n=t?e.input.text:e.output.text;"[object Array]"!==Object.prototype.toString.call(n)&&(n=[n]);var a=[];return n.forEach(function(e){if(e){var n={tagName:"div",classNames:["segments"],children:[{tagName:"div",classNames:[t?"from-user":"from-watson","latest",0===a.length?"top":"sub"],children:[{tagName:"div",classNames:["message-inner"],children:[{tagName:"p",text:e}]}]}]};a.push(Common.buildDomElement(n))}}),a}function r(){var e=document.querySelector("#scrollingChat"),t=e.querySelector(m.selectors.fromUser+m.selectors.latest);t&&(e.scrollTop=t.offsetTop),$(".content").mCustomScrollbar("scrollTo","last")}var l=[],u=new Date,p=1,d=1,m={selectors:{chatBox:"#scrollingChat",fromUser:".from-user",fromWatson:".from-watson",latest:".latest"},authorTypes:{user:"user",watson:"watson"}};return{init:function(){localStorage.setItem("gt","0"),n(),Api.sendRequest("",null),a()},inputKeyDown:function(e,n){if(13===e.keyCode&&n.value){var a,s=Api.getResponsePayload();s&&(a=s.context),"request"==localStorage.getItem("gt")?t(n.value,a):Api.sendRequest(n.value,a),n.value="",Common.fireEvent(n,"input"),++d}}}}();